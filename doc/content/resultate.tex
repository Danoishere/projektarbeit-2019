%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  _____   ____  _____                                          %
% |_   _| /  __||  __ \    Institute of Computitional Physics   %
%   | |  |  /   | |__) |   Zuercher Hochschule Winterthur       %
%   | |  | (    |  ___/    (University of Applied Sciences)     %
%  _| |_ |  \__ | |        8401 Winterthur, Switzerland         %
% |_____| \____||_|                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Project     : LaTeX doc Vorlage f√ºr Windows ProTeXt mit TexMakerX
% Title       : 
% File        : resultate.tex Rev. 00
% Date        : 23.4.12
% Author      : Remo Ritzmann
% Feedback bitte an Email: remo.ritzmann@pfunzle.ch
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%29%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Results}\label{chap.resultate}
\section{Round 1}
Our submission for Flatland round 1 does not include all algorithmic improvements discussed in this work. None the less, we were able to achieve a significant improvement in performance compared to the baseline version from \cite{flatlandstephan}.
Our submission for round 1 contains the following components:
\begin{itemize}
	\item Custom A3C implementation without experience replay buffer.
	\item Default TreeObsForRailEnv (in round 1, this was a numeric vector by default).
	\item Policy learned by curriculum learning.
	\item Distributed training over multiple processes on the same machine (no cross-machine distribution possible yet).
\end{itemize}
Using the performance evaluation system provided together with the Flatland environment, we reach the following performance metrics:
\begin{table}[H]
	\centering
	\begin{tabular}{ |c|c|c|c| } 
		\hline
		\textbf{Author} & \textbf{Observation type} & \textbf{Local Evaluation Score} & \textbf{Submission Score} \\
		\hline
		S. Huschauer & reduced grid observation & 19.4\% & 16.6\% \\
		& tree observation & 24.7\% & - \\
		Meier/Roost & tree observation & 69.3\% & 48.9\% \\
		\hline
	\end{tabular}
	\caption{Comparison of submission performance for Flatland challenge round 1.}
	\label{table:results_round1}
\end{table}
\section{Round 2}
Our submission for Flatland round 2 contains all in this work discussed improvements of the algorithm except communication. While a direct comparison is difficult due to a lack of a baseline version for round 2, we could still show in our experiments how our adjustments to the implementation improved the performance of our solution.\\
To evaluate the performance of the final model, we create an experiment with an increasing number of agents. We use an environment of the dimensions 30x30 tiles and keep all other environment parameters to a fixed value. Only the number of agents gets increased. For each number of agents, we run 20 episodes and evaluate the median, the 0.25-quantile and the 0.75-quantile.
\begin{figure}[H]
	\begin{center}
		\input{diagrams/final_comparison_departing_arrival.pgf}
	\end{center}
	\caption{Agents departing vs. agents arriving on a 30x30 environment.}
	\label{chart:departing_arriving}
\end{figure}
In \autoref{chart:departing_arriving}, it can be observed that our model is performing very well for environments with 10 agents or less. For environments with more agents, the performance gradually gets worse. It is important to note that this change in performance is not only dependent on the absolute number of agents but also on the density of agents relative to the size of the environment.\\
The evaluation system for Flatland round 2 uses 250 different environments with sizes between 20x20 to 150x150 \cite{flatland_faq}. The number of agents varies from 50 to 200.
Evaluated with the Flatland round 2 evaluator, we achieve a score of \textbf{29.1\%} of arriving agents. At the time of submission, our submission performs the 4th best out of 24 contestants that have submitted a solution for round 2 at this point. Please note, that this is not the final ranking of the Flatland challenge.\\
When analyzing our solution in selected example environments, it can be observed that agents especially struggle in two cases:
\begin{enumerate}
	\item Two agents have to take a decision at the same time.
	\item Agents deadlock each other in areas with many switches.
\end{enumerate}
Possible solutions for the listed problems are discussed in both \autoref{agent_communication} and \autoref{chap.diskussion}.







